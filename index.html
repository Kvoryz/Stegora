<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stegora</title>
    <meta
      name="description"
      content="Hide secret messages inside images with advanced LSB steganography. Encode and decode hidden text securely."
    />
    <link rel="icon" type="image/png" href="assets/iconste.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/style.css?v=4.5" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#000000" />
  </head>
  <body>
    <canvas id="particle-canvas"></canvas>
    <div class="app-container">
      <header class="header">
        <div class="logo">
          <img class="logo-icon" src="assets/iconste.png" alt="Stegora" />
          <span class="logo-text">Stegora</span>
        </div>
        <p class="tagline">Hide secrets in plain sight</p>
      </header>

      <!-- Category Tabs -->
      <nav class="category-tabs">
        <button class="category-tab active" data-category="image">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="3" width="18" height="18" rx="2" />
            <circle cx="8.5" cy="8.5" r="1.5" />
            <path d="M21 15l-5-5L5 21" />
          </svg>
          Image
        </button>
        <button class="category-tab" data-category="file">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
            />
            <polyline points="14 2 14 8 20 8" />
          </svg>
          File
        </button>
        <button class="category-tab" data-category="crypto">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
          </svg>
          Crypto
        </button>
      </nav>

      <!-- Sub-tabs for each category -->
      <nav class="sub-tabs" id="sub-tabs-image">
        <button class="sub-tab active" data-tab="stego">Steganography</button>
        <button class="sub-tab" data-tab="scramble">Scramble</button>
        <button class="sub-tab" data-tab="metadata">Metadata</button>
        <button class="sub-tab" data-tab="analysis">Analysis</button>
        <button class="sub-tab" data-tab="redact">Redact</button>
      </nav>
      <nav class="sub-tabs" id="sub-tabs-file" hidden>
        <button class="sub-tab active" data-tab="audio">Audio Stego</button>
        <button class="sub-tab" data-tab="file-encrypt">File Lock</button>
        <button class="sub-tab" data-tab="file-base64">Base64</button>
        <button class="sub-tab" data-tab="file-splitter">Splitter</button>
        <button class="sub-tab" data-tab="magic-bytes">Magic Bytes</button>
      </nav>
      <nav class="sub-tabs" id="sub-tabs-crypto" hidden>
        <button class="sub-tab active" data-tab="morse">Morse</button>
        <button class="sub-tab" data-tab="cipher">Cipher</button>
        <button class="sub-tab" data-tab="number-system">Number</button>
        <button class="sub-tab" data-tab="invisible-ink">Invisible Ink</button>
        <button class="sub-tab" data-tab="hash-gen">Hash</button>
        <button class="sub-tab" data-tab="tools">Tools</button>
      </nav>

      <main class="main-content">
        <!-- Metadata Panel (Exif, Sanitize) -->
        <section class="panel" id="metadata-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="exif">
              Exif Data
            </button>
            <button class="inner-tab" data-inner="sanitize">Sanitize</button>
          </nav>

          <!-- Inner: Exif Data (formerly Analyze) -->
          <div class="inner-panel active" id="inner-exif">
            <div class="upload-zone" id="analyze-dropzone">
              <input
                type="file"
                id="analyze-input"
                accept=".jpg,.jpeg,.png,.webp,.bmp,.heic,.tiff"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="M21 21l-4.35-4.35" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop image to inspect Exif</p>
                  <span class="upload-hint"
                    >Select Original File (not Gallery)</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="analyze-preview" hidden>
                <img id="analyze-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-view"
                    data-target="analyze-preview-img"
                    title="View"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="preview-remove"
                    id="analyze-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <span class="preview-label">Image loaded</span>
              </div>
            </div>

            <div id="exif-actions" hidden>
              <button class="btn primary" id="analyze-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="M21 21l-4.35-4.35" />
                </svg>
                Inspect Exif Data
              </button>
            </div>

            <div
              class="analysis-results"
              id="analysis-results"
              hidden
              style="
                background: var(--bg-secondary);
                border-radius: 12px;
                border: 1px solid var(--border-color);
                overflow: hidden;
              "
            >
              <div
                class="result-header"
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  padding: 12px 16px;
                  background: var(--bg-tertiary);
                  border-bottom: 1px solid var(--border-color);
                "
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--accent)"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="M21 21l-4.35-4.35" />
                </svg>
                <h3 style="font-size: 0.95rem; font-weight: 600">
                  Exif Data Found
                </h3>
              </div>
              <div
                class="analysis-content"
                style="
                  padding: 16px;
                  display: flex;
                  flex-direction: column;
                  gap: 16px;
                "
              >
                <!-- File Info -->
                <div
                  class="meta-section"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <h4
                    style="
                      font-size: 0.85rem;
                      font-weight: 600;
                      margin-bottom: 10px;
                      display: flex;
                      align-items: center;
                      gap: 6px;
                    "
                  >
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="var(--text-secondary)"
                      stroke-width="2"
                    >
                      <path
                        d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
                      />
                      <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" />
                    </svg>
                    File Info
                  </h4>
                  <div class="meta-grid" style="display: grid; gap: 6px">
                    <div
                      class="meta-row"
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >Type:</span
                      >
                      <span id="meta-type" style="font-weight: 500"></span>
                    </div>
                    <div
                      class="meta-row"
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >Size:</span
                      >
                      <span id="meta-size" style="font-weight: 500"></span>
                    </div>
                    <div
                      class="meta-row"
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >Dimensions:</span
                      >
                      <span id="meta-dims" style="font-weight: 500"></span>
                    </div>
                  </div>
                </div>

                <!-- Privacy Scan -->
                <div
                  class="meta-section"
                  id="privacy-scan-section"
                  style="border-radius: 8px; padding: 12px"
                >
                  <h4
                    style="
                      font-size: 0.85rem;
                      font-weight: 600;
                      margin-bottom: 10px;
                      display: flex;
                      align-items: center;
                      gap: 6px;
                    "
                  >
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="var(--text-secondary)"
                      stroke-width="2"
                    >
                      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                    </svg>
                    Privacy Scan
                  </h4>
                  <div
                    class="meta-warning"
                    style="
                      padding: 10px;
                      border-radius: 6px;
                      text-align: center;
                    "
                  >
                    <span
                      id="meta-hidden"
                      style="font-size: 0.9rem; font-weight: 500"
                      >Checking...</span
                    >
                  </div>
                </div>

                <!-- Exif Data -->
                <div
                  class="meta-section"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <h4
                    style="
                      font-size: 0.85rem;
                      font-weight: 600;
                      margin-bottom: 10px;
                      display: flex;
                      align-items: center;
                      gap: 6px;
                    "
                  >
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="var(--text-secondary)"
                      stroke-width="2"
                    >
                      <rect x="3" y="3" width="18" height="18" rx="2" />
                      <circle cx="8.5" cy="8.5" r="1.5" />
                      <path d="M21 15l-5-5L5 21" />
                    </svg>
                    Exif Details
                  </h4>
                  <div class="meta-grid" style="display: grid; gap: 6px">
                    <div
                      class="meta-row"
                      id="row-camera"
                      hidden
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >üì∑ Camera:</span
                      >
                      <span id="meta-camera" style="font-weight: 500"></span>
                    </div>
                    <div
                      class="meta-row"
                      id="row-date"
                      hidden
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >üìÖ Date Taken:</span
                      >
                      <span id="meta-date" style="font-weight: 500"></span>
                    </div>
                    <div
                      class="meta-row"
                      id="row-gps"
                      hidden
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >üìç GPS:</span
                      >
                      <span
                        id="meta-gps"
                        style="font-weight: 500; color: var(--error)"
                      ></span>
                    </div>
                    <div
                      class="meta-row"
                      id="row-software"
                      hidden
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >üíª Software:</span
                      >
                      <span id="meta-software" style="font-weight: 500"></span>
                    </div>
                    <div
                      class="meta-row"
                      id="row-other"
                      hidden
                      style="
                        display: flex;
                        justify-content: space-between;
                        font-size: 0.85rem;
                      "
                    >
                      <span
                        class="meta-label"
                        style="color: var(--text-secondary)"
                        >üîñ Other:</span
                      >
                      <span id="meta-other" style="font-weight: 500"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Inner: Sanitize -->
          <div class="inner-panel" id="inner-sanitize">
            <div class="upload-zone" id="sanitize-dropzone">
              <input
                type="file"
                id="sanitize-input"
                accept=".jpg,.jpeg,.png,.webp,.bmp,.heic,.tiff"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop image to sanitize</p>
                  <span class="upload-hint">Removes Exif & Metadata</span>
                </div>
              </div>
              <div class="preview-thumb" id="sanitize-preview" hidden>
                <img id="sanitize-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-view"
                    data-target="sanitize-preview-img"
                    title="View"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="preview-remove"
                    id="sanitize-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <span class="preview-label">Image loaded</span>
              </div>
            </div>

            <div id="sanitize-actions" hidden>
              <button class="btn primary" id="sanitize-action-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
                Sanitize & Download
              </button>
            </div>
          </div>
        </section>

        <!-- Analysis Panel (Steganalysis) -->
        <section class="panel" id="analysis-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="steganalysis">
              Image Diff
            </button>
            <button class="inner-tab" data-inner="lsb-analysis">
              LSB Analysis
            </button>
          </nav>

          <!-- Inner: Steganalysis (Image Diff) -->
          <div class="inner-panel active" id="inner-steganalysis">
            <div
              class="compare-container"
              style="
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
                margin-bottom: 1.5rem;
              "
            >
              <!-- Original Image -->
              <div
                class="compare-box"
                style="
                  background: var(--bg-secondary);
                  border-radius: 12px;
                  padding: 12px;
                  border: 1px solid var(--border-color);
                "
              >
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 8px;
                  "
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="var(--success)"
                    stroke-width="2"
                  >
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <circle cx="8.5" cy="8.5" r="1.5" />
                    <path d="M21 15l-5-5L5 21" />
                  </svg>
                  <span
                    style="
                      font-size: 0.85rem;
                      font-weight: 600;
                      color: var(--success);
                    "
                    >Original</span
                  >
                </div>
                <div
                  class="upload-zone"
                  id="steg-orig-dropzone"
                  style="height: 120px; border-style: dashed"
                >
                  <input
                    type="file"
                    id="steg-orig-input"
                    accept="image/*"
                    hidden
                  />
                  <div class="upload-content" style="padding: 8px">
                    <p class="upload-text" style="font-size: 0.85rem">
                      Drop or Click
                    </p>
                    <span class="upload-hint" style="font-size: 0.75rem"
                      >Before encoding</span
                    >
                  </div>
                  <div
                    class="preview-thumb"
                    id="steg-orig-preview"
                    hidden
                    style="padding: 8px"
                  >
                    <img id="steg-orig-img" style="width: 40px; height: 40px" />
                    <span
                      class="preview-label"
                      style="font-size: 0.75rem; flex: 1"
                      >Loaded</span
                    >
                    <div class="preview-actions">
                      <button
                        type="button"
                        class="preview-remove"
                        id="steg-orig-remove"
                      >
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Suspect Image -->
              <div
                class="compare-box"
                style="
                  background: var(--bg-secondary);
                  border-radius: 12px;
                  padding: 12px;
                  border: 1px solid var(--border-color);
                "
              >
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 8px;
                  "
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="var(--error)"
                    stroke-width="2"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 8v4M12 16h.01" />
                  </svg>
                  <span
                    style="
                      font-size: 0.85rem;
                      font-weight: 600;
                      color: var(--error);
                    "
                    >Suspect</span
                  >
                </div>
                <div
                  class="upload-zone"
                  id="steg-susp-dropzone"
                  style="height: 120px; border-style: dashed"
                >
                  <input
                    type="file"
                    id="steg-susp-input"
                    accept="image/*"
                    hidden
                  />
                  <div class="upload-content" style="padding: 8px">
                    <p class="upload-text" style="font-size: 0.85rem">
                      Drop or Click
                    </p>
                    <span class="upload-hint" style="font-size: 0.75rem"
                      >After encoding</span
                    >
                  </div>
                  <div
                    class="preview-thumb"
                    id="steg-susp-preview"
                    hidden
                    style="padding: 8px"
                  >
                    <img id="steg-susp-img" style="width: 40px; height: 40px" />
                    <span
                      class="preview-label"
                      style="font-size: 0.75rem; flex: 1"
                      >Loaded</span
                    >
                    <div class="preview-actions">
                      <button
                        type="button"
                        class="preview-remove"
                        id="steg-susp-remove"
                      >
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="steg-actions" hidden>
              <div
                class="controls-group"
                style="
                  background: var(--bg-secondary);
                  padding: 1rem;
                  border-radius: 12px;
                  margin-bottom: 1rem;
                  border: 1px solid var(--border-color);
                "
              >
                <div
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 8px;
                  "
                >
                  <label
                    for="diff-amp"
                    style="
                      font-size: 0.85rem;
                      font-weight: 500;
                      display: flex;
                      align-items: center;
                      gap: 6px;
                    "
                  >
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="var(--accent)"
                      stroke-width="2"
                    >
                      <circle cx="11" cy="11" r="8" />
                      <path d="M21 21l-4.35-4.35" />
                      <path d="M11 8v6M8 11h6" />
                    </svg>
                    Amplification
                  </label>
                  <span
                    id="amp-value"
                    style="
                      font-size: 0.85rem;
                      font-weight: 600;
                      color: var(--accent);
                    "
                    >10x</span
                  >
                </div>
                <input
                  type="range"
                  id="diff-amp"
                  min="1"
                  max="100"
                  value="10"
                  style="width: 100%; accent-color: var(--accent)"
                />
                <p
                  style="
                    font-size: 0.75rem;
                    color: var(--text-muted);
                    margin-top: 6px;
                  "
                >
                  Higher values reveal subtler pixel changes.
                </p>
              </div>

              <button class="btn primary" id="steg-compare-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 21l-4.35-4.35" />
                  <circle cx="11" cy="11" r="8" />
                </svg>
                Compare Images
              </button>
            </div>

            <div
              class="analysis-results"
              id="steg-results"
              hidden
              style="
                margin-top: 1.5rem;
                background: var(--bg-secondary);
                border-radius: 12px;
                padding: 1rem;
                border: 1px solid var(--border-color);
              "
            >
              <h3
                style="
                  font-size: 1rem;
                  margin-bottom: 0.75rem;
                  display: flex;
                  align-items: center;
                  gap: 8px;
                "
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--accent)"
                  stroke-width="2"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <path d="M3 9h18M9 21V9" />
                </svg>
                Difference Map
              </h3>
              <canvas
                id="diff-canvas"
                style="
                  width: 100%;
                  border-radius: 8px;
                  border: 1px solid var(--border-color);
                "
              ></canvas>
              <p
                id="diff-stats"
                style="
                  margin-top: 0.75rem;
                  text-align: center;
                  font-size: 0.9rem;
                  padding: 8px;
                  background: var(--bg-tertiary);
                  border-radius: 8px;
                "
              ></p>
            </div>
          </div>

          <!-- Inner: LSB Analysis (Single Image) -->
          <div class="inner-panel" id="inner-lsb-analysis">
            <div class="upload-zone" id="lsb-dropzone">
              <input type="file" id="lsb-input" accept="image/*" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M21 21l-4.35-4.35" />
                  <circle cx="11" cy="11" r="8" />
                  <path d="M11 8v6M8 11h6" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop image to analyze</p>
                  <span class="upload-hint"
                    >Detect hidden data using LSB statistics</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="lsb-preview" hidden>
                <img id="lsb-img" />
                <span class="preview-label" id="lsb-filename"></span>
                <div class="preview-actions">
                  <button type="button" class="preview-remove" id="lsb-remove">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <div id="lsb-actions" hidden>
              <button class="btn primary" id="lsb-analyze-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 21l-4.35-4.35" />
                  <circle cx="11" cy="11" r="8" />
                </svg>
                Analyze LSB
              </button>
            </div>

            <div class="lsb-results" id="lsb-results" hidden>
              <div
                class="verdict-box"
                id="lsb-verdict-box"
                style="
                  padding: 1rem;
                  border-radius: 12px;
                  margin-bottom: 1rem;
                  text-align: center;
                "
              >
                <h3
                  id="lsb-verdict"
                  style="font-size: 1.5rem; margin-bottom: 0.5rem"
                >
                  Analyzing...
                </h3>
                <p
                  id="lsb-verdict-desc"
                  style="font-size: 0.9rem; opacity: 0.8"
                ></p>
              </div>

              <div
                class="stats-grid"
                style="
                  display: grid;
                  grid-template-columns: repeat(2, 1fr);
                  gap: 1rem;
                  margin-bottom: 1rem;
                "
              >
                <div
                  class="stat-box"
                  style="
                    background: var(--bg-secondary);
                    padding: 1rem;
                    border-radius: 8px;
                    text-align: center;
                  "
                >
                  <p style="font-size: 0.8rem; color: var(--text-secondary)">
                    Chi-Square Score
                  </p>
                  <p id="lsb-chi" style="font-size: 1.5rem; font-weight: 600">
                    -
                  </p>
                </div>
                <div
                  class="stat-box"
                  style="
                    background: var(--bg-secondary);
                    padding: 1rem;
                    border-radius: 8px;
                    text-align: center;
                  "
                >
                  <p style="font-size: 0.8rem; color: var(--text-secondary)">
                    LSB Entropy
                  </p>
                  <p
                    id="lsb-entropy"
                    style="font-size: 1.5rem; font-weight: 600"
                  >
                    -
                  </p>
                </div>
              </div>

              <h4 style="margin-bottom: 0.5rem">LSB Plane Visualization</h4>
              <canvas
                id="lsb-canvas"
                style="
                  width: 100%;
                  border-radius: 8px;
                  border: 1px solid var(--border-color);
                "
              ></canvas>
              <p
                style="
                  font-size: 0.75rem;
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  text-align: center;
                "
              >
                Blue channel LSB extracted. Patterns may indicate hidden data.
              </p>
            </div>
          </div>
        </section>

        <!-- Redact Panel (Obfuscator) -->
        <section class="panel" id="redact-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="obfuscate">
              Obfuscate
            </button>
            <button class="inner-tab" data-inner="color-picker">
              Color Extract
            </button>
          </nav>

          <div class="inner-panel active" id="inner-obfuscate">
            <div class="upload-zone" id="redact-dropzone">
              <input type="file" id="redact-input" accept="image/*" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"
                  />
                  <line x1="1" y1="1" x2="23" y2="23" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop image to Redact</p>
                  <span class="upload-hint"
                    >Blur or Pixelate sensitive info</span
                  >
                </div>
              </div>
            </div>

            <div class="redact-editor" id="redact-editor" hidden>
              <div class="redact-toolbar">
                <div class="tool-group">
                  <button
                    class="btn sm active"
                    id="tool-pixelate"
                    title="Pixelate"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        d="M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z"
                      />
                    </svg>
                    <span>Pixelate</span>
                  </button>
                  <button class="btn sm" id="tool-blur" title="Blur">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"
                      />
                      <path
                        d="M12 6a6 6 0 1 0 6 6 6 6 0 0 0-6-6z"
                        opacity="0.5"
                      />
                    </svg>
                    <span>Blur</span>
                  </button>
                </div>

                <div class="tool-group flex-grow">
                  <label class="compact-label">Strength</label>
                  <input
                    type="range"
                    id="redact-strength"
                    min="1"
                    max="20"
                    value="8"
                  />
                </div>

                <div class="tool-group">
                  <button
                    class="btn sm secondary icon-only"
                    id="redact-undo"
                    title="Undo Last"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M3 7v6h6" />
                      <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13" />
                    </svg>
                  </button>
                  <button
                    class="btn sm secondary icon-only"
                    id="redact-reset"
                    title="Reset Changes"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M23 4v6h-6" />
                      <path d="M1 20v-6h6" />
                      <path
                        d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"
                      />
                    </svg>
                  </button>
                  <button
                    class="btn sm danger icon-only"
                    id="redact-delete"
                    title="Remove Image"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="3 6 5 6 21 6"></polyline>
                      <path
                        d="M19 6v14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                      ></path>
                    </svg>
                  </button>
                  <button
                    class="btn sm primary icon-only"
                    id="redact-download"
                    title="Download"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                      <polyline points="7 10 12 15 17 10" />
                      <line x1="12" y1="15" x2="12" y2="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <div
                class="canvas-container"
                id="redact-container"
                style="
                  position: relative;
                  overflow: hidden;
                  border-radius: 8px;
                  display: inline-block;
                  max-width: 100%;
                  border: 1px solid var(--border-color);
                "
              >
                <canvas
                  id="redact-canvas"
                  style="display: block; max-width: 100%; cursor: crosshair"
                ></canvas>
              </div>

              <p
                class="help-text"
                style="
                  text-align: center;
                  font-size: 0.85rem;
                  color: var(--text-secondary);
                  margin-top: 8px;
                "
              >
                Drag over area to apply effect.
              </p>
            </div>
          </div>
          <!-- Close inner-obfuscate -->

          <!-- Inner: Color Picker -->
          <div class="inner-panel" id="inner-color-picker">
            <div class="upload-zone" id="color-dropzone">
              <input type="file" id="color-input" accept="image/*" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                  />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop image to extract colors</p>
                  <span class="upload-hint"
                    >Get dominant palette & hex codes</span
                  >
                </div>
              </div>

              <div class="preview-thumb" id="color-preview" hidden>
                <img id="color-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-remove"
                    id="color-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <div class="result-box" id="color-results" hidden>
              <div class="result-header">
                <h3>Dominant Colors</h3>
              </div>
              <div style="padding: 16px">
                <div
                  id="color-palette"
                  style="
                    display: flex;
                    gap: 8px;
                    margin-bottom: 20px;
                    flex-wrap: wrap;
                  "
                >
                  <!-- Swatches injected here -->
                </div>

                <h4
                  style="
                    font-size: 0.85rem;
                    color: var(--text-secondary);
                    margin-bottom: 10px;
                  "
                >
                  Color List
                </h4>
                <div
                  id="color-list"
                  style="
                    display: grid;
                    grid-template-columns: repeat(
                      auto-fill,
                      minmax(140px, 1fr)
                    );
                    gap: 8px;
                  "
                >
                  <!-- List items injected here -->
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Steganography Section with Inner Tabs -->
        <section class="panel active" id="stego-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="encode">Encode</button>
            <button class="inner-tab" data-inner="decode">Decode</button>
          </nav>

          <!-- Inner: Encode -->
          <div class="inner-panel active" id="inner-encode">
            <div class="upload-zone" id="encode-dropzone">
              <input
                type="file"
                id="encode-image-input"
                accept="image/png,image/jpeg,image/webp"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <circle cx="8.5" cy="8.5" r="1.5" />
                  <path d="M21 15l-5-5L5 21" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop your image here</p>
                  <span class="upload-hint">Any image format</span>
                </div>
              </div>
              <div class="preview-thumb" id="encode-preview" hidden>
                <img id="encode-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-view"
                    data-target="encode-preview-img"
                    title="View"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="preview-remove"
                    id="encode-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <span class="preview-label">Image loaded</span>
              </div>
            </div>

            <div id="hide-actions" hidden>
              <div class="input-group">
                <label for="secret-message">Secret Message</label>
                <textarea
                  id="secret-message"
                  placeholder="Enter your secret message here..."
                  rows="4"
                ></textarea>
                <div class="input-help">
                  <span id="char-count">0</span> /
                  <span id="max-chars">0</span> characters
                </div>
              </div>

              <div class="input-group">
                <label for="encode-password">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0110 0v4" />
                  </svg>
                  Password <span class="optional">(optional)</span>
                </label>
                <div class="password-input">
                  <input
                    type="password"
                    id="encode-password"
                    placeholder="Encrypt with password..."
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                    spellcheck="false"
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-encode-password"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="submit-btn" disabled>
                Submit
              </button>

              <div class="hash-display" id="encode-hash-display" hidden>
                <div class="hash-header">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                  </svg>
                  <span>Message Hash (SHA-256)</span>
                </div>
                <div class="hash-value">
                  <code id="encode-hash-value"></code>
                  <button
                    type="button"
                    class="copy-hash"
                    id="copy-encode-hash"
                    title="Copy"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Inner: Decode -->
          <div class="inner-panel" id="inner-decode">
            <div class="upload-zone" id="decode-dropzone">
              <input
                type="file"
                id="decode-image-input"
                accept="image/*"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <circle cx="8.5" cy="8.5" r="1.5" />
                  <path d="M21 15l-5-5L5 21" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop encoded image here</p>
                  <span class="upload-hint">Any image format</span>
                </div>
              </div>
              <div class="preview-thumb" id="decode-preview" hidden>
                <img id="decode-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-view"
                    data-target="decode-preview-img"
                    title="View"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="preview-remove"
                    id="decode-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <span class="preview-label">Image loaded</span>
              </div>
            </div>

            <div id="extract-actions" hidden>
              <div class="input-group">
                <label for="decode-password">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0110 0v4" />
                  </svg>
                  Password <span class="optional">(if encrypted)</span>
                </label>
                <div class="password-input">
                  <input
                    type="password"
                    id="decode-password"
                    placeholder="Enter password to decrypt..."
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                    spellcheck="false"
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-decode-password"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="decode-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0 1 9.9-1" />
                </svg>
                Decode Message
              </button>

              <div class="result-box" id="result-box" hidden>
                <div class="result-header">
                  <h3>Hidden Message</h3>
                  <button class="copy-btn" id="copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <p class="result-message" id="result-message"></p>
                <div class="hash-display decode-hash">
                  <div class="hash-header">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                    </svg>
                    <span>Hash (SHA-256)</span>
                  </div>
                  <div class="hash-value">
                    <code id="decode-hash-value"></code>
                    <button
                      type="button"
                      class="copy-hash"
                      id="copy-decode-hash"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- File Tab Panels -->

        <!-- 1. File Encryption Panel -->
        <section class="panel" id="file-encrypt-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="file-enc">
              Encrypt
            </button>
            <button class="inner-tab" data-inner="file-dec">Decrypt</button>
          </nav>

          <!-- Encrypt -->
          <div class="inner-panel active" id="inner-file-enc">
            <div class="upload-zone" id="file-enc-dropzone">
              <input type="file" id="file-enc-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M12 15a4 4 0 0 0 4-4V6a4 4 0 0 0-8 0v5a4 4 0 0 0 4 4zm0 0v6m-6-6h12"
                  />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop file to Encrypt</p>
                  <span class="upload-hint">Any file type supported</span>
                </div>
              </div>
              <div class="preview-thumb" id="file-enc-preview" hidden>
                <div style="display: flex; gap: 10px; align-items: center">
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"
                    />
                    <polyline points="13 2 13 9 20 9" />
                  </svg>
                  <span
                    class="preview-label"
                    id="file-enc-name"
                    style="word-break: break-all"
                    >filename.ext</span
                  >
                </div>
                <button
                  type="button"
                  class="preview-remove"
                  id="file-enc-remove"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>

            <div id="file-enc-actions" hidden>
              <div class="input-group">
                <label>Password</label>
                <div class="password-input">
                  <input
                    type="password"
                    id="file-enc-password"
                    placeholder="Encryption password"
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-file-enc-pass"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>
              <button class="btn primary" id="btn-file-encrypt" disabled>
                Encrypt File
              </button>
            </div>
          </div>

          <!-- Decrypt -->
          <div class="inner-panel" id="inner-file-dec">
            <div class="upload-zone" id="file-dec-dropzone">
              <input type="file" id="file-dec-input" accept=".enc" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0110 0v4" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop .enc file to Decrypt</p>
                  <span class="upload-hint">Must match password</span>
                </div>
              </div>
              <div class="preview-thumb" id="file-dec-preview" hidden>
                <div style="display: flex; gap: 10px; align-items: center">
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"
                    />
                    <polyline points="13 2 13 9 20 9" />
                  </svg>
                  <span class="preview-label" id="file-dec-name"
                    >encrypted.enc</span
                  >
                </div>
                <button
                  type="button"
                  class="preview-remove"
                  id="file-dec-remove"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>

            <div id="file-dec-actions" hidden>
              <div class="input-group">
                <label>Password</label>
                <div class="password-input">
                  <input
                    type="password"
                    id="file-dec-password"
                    placeholder="Original password"
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-file-dec-pass"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>
              <button class="btn primary" id="btn-file-decrypt" disabled>
                Decrypt File
              </button>
            </div>
          </div>
        </section>

        <!-- 2. Base64 Converter Panel -->
        <section class="panel" id="file-base64-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="base64-enc">
              Encode
            </button>
            <button class="inner-tab" data-inner="base64-dec">Decode</button>
          </nav>

          <!-- Encode Tab -->
          <div class="inner-panel active" id="inner-base64-enc">
            <div class="upload-zone" id="base64-dropzone">
              <input type="file" id="base64-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  />
                  <polyline points="14 2 14 8 20 8" />
                  <line x1="16" y1="13" x2="8" y2="13" />
                  <line x1="16" y1="17" x2="8" y2="17" />
                  <polyline points="10 9 9 9 8 9" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Convert File to Base64</p>
                  <span class="upload-hint"
                    >Useful for embedding files as text</span
                  >
                </div>
              </div>
            </div>

            <div id="base64-enc-actions" hidden>
              <div class="input-group">
                <label>Base64 Output</label>
                <div class="textarea-wrap">
                  <textarea
                    id="base64-output"
                    rows="8"
                    placeholder="Base64 string will appear here..."
                    readonly
                    style="font-family: monospace; font-size: 11px"
                  ></textarea>
                  <button
                    type="button"
                    class="textarea-clear"
                    id="base64-output-clear"
                    title="Clear"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18" />
                      <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                  </button>
                </div>
              </div>
              <div style="display: flex; gap: 10px; margin-top: 10px">
                <button class="btn secondary" id="base64-copy" style="flex: 1">
                  Copy
                </button>
                <button
                  class="btn secondary"
                  id="base64-download"
                  style="flex: 1"
                >
                  Download .txt
                </button>
              </div>
            </div>
          </div>

          <!-- Decode Tab -->
          <div class="inner-panel" id="inner-base64-dec">
            <!-- New Dropzone for Base64 Decode -->
            <div class="upload-zone" id="base64-dec-dropzone">
              <input
                type="file"
                id="base64-dec-upload-txt"
                accept=".txt"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  />
                  <polyline points="14 2 14 8 20 8" />
                  <line x1="16" y1="13" x2="8" y2="13" />
                  <line x1="16" y1="17" x2="8" y2="17" />
                  <polyline points="10 9 9 9 8 9" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop .txt file to Load</p>
                  <span class="upload-hint"
                    >Loads content into input below</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="base64-dec-preview" hidden>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    width: 100%;
                  "
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="width: 24px; height: 24px"
                  >
                    <path
                      d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                    ></path>
                  </svg>
                  <span
                    class="preview-label"
                    id="base64-dec-filename"
                    style="flex: 1; text-align: left"
                  ></span>
                  <button
                    type="button"
                    class="preview-remove"
                    id="base64-dec-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <div
              class="separator-text"
              style="
                text-align: center;
                margin: 1rem 0;
                color: var(--text-secondary);
                font-size: 0.9rem;
              "
            >
              - OR -
            </div>

            <div id="base64-dec-actions">
              <div class="input-group">
                <label>Direct Input (Paste Base64 String)</label>
                <div class="textarea-wrap">
                  <textarea
                    id="base64-decode-input"
                    rows="8"
                    placeholder="Paste Base64 here (e.g., data:image/png;base64,...)"
                  ></textarea>
                  <button
                    type="button"
                    class="textarea-clear"
                    id="base64-decode-clear"
                    title="Clear"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18" />
                      <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="btn-base64-decode">
                Decode & Download
              </button>
            </div>
          </div>
        </section>

        <!-- 3. File Splitter Panel -->
        <section class="panel" id="file-splitter-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="splitter-split">
              Split
            </button>
            <button class="inner-tab" data-inner="splitter-join">Join</button>
          </nav>

          <div class="inner-panel active" id="inner-splitter-split">
            <div class="upload-zone" id="splitter-dropzone">
              <input type="file" id="splitter-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="2" y="2" width="20" height="8" rx="2" ry="2" />
                  <rect x="2" y="14" width="20" height="8" rx="2" ry="2" />
                  <line x1="6" y1="6" x2="6.01" y2="6" />
                  <line x1="6" y1="18" x2="6.01" y2="18" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Split Large File</p>
                  <span class="upload-hint">Divide into smaller chunks</span>
                </div>
              </div>
              <div class="preview-thumb" id="splitter-preview" hidden>
                <span class="preview-label" id="splitter-name">filename</span>
                <button
                  type="button"
                  class="preview-remove"
                  id="splitter-remove"
                >
                  x
                </button>
              </div>
            </div>

            <div id="splitter-actions" hidden>
              <div class="input-group">
                <label>Chunk Size</label>
                <div class="custom-number-input">
                  <input
                    type="number"
                    id="splitter-size"
                    value="10"
                    min="1"
                    placeholder="Enter size"
                  />
                  <span class="input-suffix">MB</span>
                </div>

                <div class="size-presets">
                  <button class="size-chip" data-size="10">10MB</button>
                  <button class="size-chip" data-size="50">50MB</button>
                  <button class="size-chip" data-size="100">100MB</button>
                  <button class="size-chip" data-size="500">500MB</button>
                </div>

                <p class="char-count" style="text-align: left; margin-top: 4px">
                  Files will be split into parts of this size.
                </p>
              </div>
              <button class="btn primary" id="btn-split-file" disabled>
                Split & Download
              </button>
            </div>
          </div>

          <div class="inner-panel" id="inner-splitter-join">
            <div class="upload-zone" id="join-dropzone">
              <input type="file" id="join-input" multiple hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M8 7v10h8V7m-8 0h8M8 7H5a3 3 0 000 6h3M16 7h3a3 3 0 010 6h-3"
                  />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Merge Split Files</p>
                  <span class="upload-hint"
                    >Select all chunk files (.001, .002, etc)</span
                  >
                </div>
              </div>
            </div>

            <div id="join-file-list" style="margin-top: 1rem" hidden>
              <div class="result-header">
                <h3>Selected Chunks (<span id="join-count">0</span>)</h3>
                <button class="copy-btn" id="join-clear">Clear</button>
              </div>
              <div
                id="join-list-content"
                style="
                  max-height: 200px;
                  overflow-y: auto;
                  padding: 8px;
                  background: var(--bg-secondary);
                  border: 1px solid var(--border-color);
                  border-radius: 0 0 8px 8px;
                  display: flex;
                  flex-direction: column;
                  gap: 4px;
                "
              ></div>
            </div>

            <button
              class="btn primary"
              id="btn-join-file"
              hidden
              style="margin-top: 1rem"
            >
              Merge & Download
            </button>
          </div>
        </section>

        <!-- 4. Magic Bytes Panel -->
        <section class="panel" id="magic-bytes-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="magic-analyze">
              Analyze
            </button>
            <button class="inner-tab" data-inner="magic-deepscan">
              Deep Scan
            </button>
            <button class="inner-tab" data-inner="magic-hexedit">
              Hex Editor
            </button>
          </nav>

          <div class="inner-panel active" id="inner-magic-analyze">
            <div class="upload-zone" id="magic-dropzone">
              <input type="file" id="magic-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Detect Real File Type</p>
                  <span class="upload-hint"
                    >Analyze file signature (magic bytes)</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="magic-preview" hidden>
                <div
                  style="display: flex; align-items: center; gap: 10px; flex: 1"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="width: 24px; height: 24px; flex-shrink: 0"
                  >
                    <path
                      d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"
                    />
                    <polyline points="13 2 13 9 20 9" />
                  </svg>
                  <span
                    class="preview-label"
                    id="magic-filename"
                    style="word-break: break-all"
                    >filename.ext</span
                  >
                </div>
                <button type="button" class="preview-remove" id="magic-remove">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>

            <div
              class="result-box"
              id="magic-result"
              hidden
              style="margin-top: 20px; padding: 20px; text-align: center"
            >
              <h3 style="margin-bottom: 10px; color: var(--text-secondary)">
                Detected Type
              </h3>
              <div
                id="magic-type"
                style="
                  font-size: 1.5rem;
                  font-weight: bold;
                  color: var(--accent);
                  margin-bottom: 5px;
                "
              >
                PNG Image
              </div>
              <div
                id="magic-mime"
                style="font-family: monospace; color: var(--text-muted)"
              >
                image/png
              </div>
              <div
                id="magic-hex"
                style="
                  margin-top: 15px;
                  font-family: monospace;
                  background: var(--bg-tertiary);
                  padding: 10px;
                  border-radius: 6px;
                  font-size: 12px;
                "
              >
                89 50 4E 47 0D 0A 1A 0A
              </div>

              <div
                id="magic-fix-area"
                style="
                  margin-top: 15px;
                  padding: 12px;
                  background: rgba(34, 197, 94, 0.1);
                  border: 1px solid var(--success);
                  border-radius: 8px;
                "
                hidden
              >
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 8px;
                    color: var(--success);
                    font-weight: 600;
                    font-size: 13px;
                  "
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M22 11.08V12a10 10 0 11-5.93-9.14" />
                    <polyline points="22 4 12 14.01 9 11.01" />
                  </svg>
                  Extension Mismatch Detected!
                </div>
                <p
                  style="
                    font-size: 13px;
                    color: var(--text-secondary);
                    margin-bottom: 12px;
                    text-align: left;
                  "
                >
                  The file seems to be a
                  <strong
                    id="magic-real-type"
                    style="color: var(--text-primary)"
                    >PNG</strong
                  >, but has a different extension.
                </p>
                <button
                  class="btn secondary small"
                  id="magic-fix-btn"
                  style="
                    width: 100%;
                    justify-content: center;
                    background: var(--bg-primary);
                  "
                >
                  Fix Extension & Download
                </button>
              </div>
            </div>
          </div>

          <!-- Deep Scan Tab -->
          <div class="inner-panel" id="inner-magic-deepscan">
            <div class="upload-zone" id="deepscan-dropzone">
              <input type="file" id="deepscan-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="M21 21l-4.35-4.35" />
                  <path d="M11 8v6M8 11h6" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Deep Scan for Embedded Files</p>
                  <span class="upload-hint"
                    >Find hidden files inside another file</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="deepscan-preview" hidden>
                <div
                  style="display: flex; align-items: center; gap: 10px; flex: 1"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="width: 24px; height: 24px; flex-shrink: 0"
                  >
                    <path
                      d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"
                    />
                    <polyline points="13 2 13 9 20 9" />
                  </svg>
                  <span
                    class="preview-label"
                    id="deepscan-filename"
                    style="word-break: break-all"
                    >filename.ext</span
                  >
                </div>
                <button
                  type="button"
                  class="preview-remove"
                  id="deepscan-remove"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>

            <div id="deepscan-progress" hidden style="margin-top: 15px">
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 10px;
                  color: var(--text-secondary);
                "
              >
                <div class="spinner"></div>
                <span id="deepscan-status">Scanning...</span>
              </div>
              <div
                style="
                  margin-top: 10px;
                  height: 4px;
                  background: var(--bg-tertiary);
                  border-radius: 2px;
                  overflow: hidden;
                "
              >
                <div
                  id="deepscan-bar"
                  style="
                    height: 100%;
                    width: 0%;
                    background: var(--accent);
                    transition: width 0.3s;
                  "
                ></div>
              </div>
            </div>

            <div
              class="result-box"
              id="deepscan-result"
              hidden
              style="margin-top: 20px"
            >
              <div class="result-header">
                <h3>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="
                      width: 18px;
                      height: 18px;
                      vertical-align: middle;
                      margin-right: 6px;
                    "
                  >
                    <circle cx="11" cy="11" r="8" />
                    <path d="M21 21l-4.35-4.35" />
                  </svg>
                  Embedded Files Found (<span id="deepscan-count">0</span>)
                </h3>
              </div>
              <div
                id="deepscan-list"
                style="
                  max-height: 300px;
                  overflow-y: auto;
                  display: flex;
                  flex-direction: column;
                  gap: 8px;
                  padding: 12px;
                "
              ></div>
            </div>

            <div
              id="deepscan-empty"
              hidden
              style="
                margin-top: 20px;
                padding: 20px;
                text-align: center;
                color: var(--text-muted);
                background: var(--bg-tertiary);
                border-radius: 8px;
              "
            >
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                style="
                  width: 40px;
                  height: 40px;
                  margin-bottom: 10px;
                  opacity: 0.5;
                "
              >
                <circle cx="12" cy="12" r="10" />
                <path d="M8 15s1.5 2 4 2 4-2 4-2M9 9h.01M15 9h.01" />
              </svg>
              <p>No embedded files detected</p>
              <span style="font-size: 12px"
                >File appears clean or uses unknown format</span
              >
            </div>
          </div>

          <!-- Hex Editor Tab -->
          <div class="inner-panel" id="inner-magic-hexedit">
            <div class="upload-zone" id="hexedit-dropzone">
              <input type="file" id="hexedit-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <path d="M9 3v18M15 3v18M3 9h18M3 15h18" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Mini Hex Editor</p>
                  <span class="upload-hint"
                    >View and edit file bytes directly</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="hexedit-preview" hidden>
                <div
                  style="display: flex; align-items: center; gap: 10px; flex: 1"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="width: 24px; height: 24px; flex-shrink: 0"
                  >
                    <path
                      d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"
                    />
                    <polyline points="13 2 13 9 20 9" />
                  </svg>
                  <span
                    class="preview-label"
                    id="hexedit-fname"
                    style="word-break: break-all"
                    >filename.ext</span
                  >
                </div>
                <button
                  type="button"
                  class="preview-remove"
                  id="hexedit-remove"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>

            <div id="hexedit-container" hidden style="margin-top: 15px">
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 10px;
                "
              >
                <span
                  id="hexedit-filename"
                  style="
                    font-weight: 600;
                    color: var(--text-primary);
                    font-size: 14px;
                  "
                ></span>
                <span
                  id="hexedit-filesize"
                  style="color: var(--text-muted); font-size: 12px"
                ></span>
              </div>

              <div
                style="
                  display: flex;
                  gap: 10px;
                  margin-bottom: 10px;
                  align-items: center;
                "
              >
                <label style="font-size: 12px; color: var(--text-secondary)"
                  >Offset:</label
                >
                <input
                  type="number"
                  id="hexedit-offset"
                  value="0"
                  min="0"
                  style="
                    width: 100px;
                    padding: 6px 10px;
                    background: var(--bg-tertiary);
                    border: 1px solid var(--border-color);
                    border-radius: 4px;
                    color: var(--text-primary);
                    font-family: monospace;
                  "
                />
                <button class="btn secondary small" id="hexedit-goto">
                  Go
                </button>
                <span
                  style="
                    margin-left: auto;
                    font-size: 11px;
                    color: var(--text-muted);
                  "
                  >Showing 256 bytes</span
                >
              </div>

              <div
                style="
                  display: grid;
                  grid-template-columns: 80px 1fr 1fr;
                  gap: 2px;
                  font-family: monospace;
                  font-size: 11px;
                  background: var(--bg-tertiary);
                  border-radius: 8px;
                  overflow: hidden;
                "
              >
                <div
                  style="
                    padding: 8px;
                    background: var(--bg-secondary);
                    color: var(--text-muted);
                    text-align: center;
                    font-weight: 600;
                  "
                >
                  Offset
                </div>
                <div
                  style="
                    padding: 8px;
                    background: var(--bg-secondary);
                    color: var(--text-muted);
                    text-align: center;
                    font-weight: 600;
                  "
                >
                  Hex
                </div>
                <div
                  style="
                    padding: 8px;
                    background: var(--bg-secondary);
                    color: var(--text-muted);
                    text-align: center;
                    font-weight: 600;
                  "
                >
                  ASCII
                </div>
              </div>

              <div
                id="hexedit-content"
                style="
                  max-height: 320px;
                  overflow-y: auto;
                  background: var(--bg-primary);
                  border: 1px solid var(--border-color);
                  border-radius: 0 0 8px 8px;
                "
              ></div>

              <div
                style="
                  display: flex;
                  gap: 10px;
                  margin-top: 15px;
                  flex-wrap: wrap;
                "
              >
                <button class="btn secondary" id="hexedit-download">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="width: 16px; height: 16px"
                  >
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                    <polyline points="7 10 12 15 17 10" />
                    <line x1="12" y1="15" x2="12" y2="3" />
                  </svg>
                  Download Modified
                </button>
                <button class="btn secondary" id="hexedit-reset">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    style="width: 16px; height: 16px"
                  >
                    <path d="M3 12a9 9 0 109-9 9.75 9.75 0 00-6.74 2.74L3 8" />
                    <path d="M3 3v5h5" />
                  </svg>
                  Reset Changes
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- Audio Section -->
        <section class="panel" id="audio-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="audio-encode">
              Hide in Audio
            </button>
            <button class="inner-tab" data-inner="audio-decode">
              Extract from Audio
            </button>
          </nav>

          <!-- Audio Encode -->
          <div class="inner-panel active" id="inner-audio-encode">
            <div class="upload-zone" id="audio-encode-dropzone">
              <input
                type="file"
                id="audio-encode-input"
                accept="audio/wav"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M9 18V5l12-2v13" />
                  <circle cx="6" cy="18" r="3" />
                  <circle cx="18" cy="16" r="3" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop your WAV file here</p>
                  <span class="upload-hint">WAV format only</span>
                </div>
              </div>
              <div class="preview-thumb" id="audio-encode-preview" hidden>
                <svg
                  class="audio-thumb-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M9 18V5l12-2v13" />
                  <circle cx="6" cy="18" r="3" />
                  <circle cx="18" cy="16" r="3" />
                </svg>
                <span class="preview-label" id="audio-encode-filename"
                  >audio.wav</span
                >
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-remove"
                    id="audio-encode-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <div id="audio-enc-actions" hidden>
              <div class="input-group">
                <label for="audio-secret-message">Secret Message</label>
                <textarea
                  id="audio-secret-message"
                  placeholder="Enter your secret message here..."
                  rows="3"
                ></textarea>
              </div>

              <div class="input-group">
                <label for="audio-encode-password">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0110 0v4" />
                  </svg>
                  Password <span class="optional">(optional)</span>
                </label>
                <div class="password-input">
                  <input
                    type="password"
                    id="audio-encode-password"
                    placeholder="Encrypt with password..."
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-audio-encode-password"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="audio-encode-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M12 15V3M12 3L7 8M12 3l5 5" />
                  <path
                    d="M2 17l.621 2.485A2 2 0 004.561 21h14.878a2 2 0 001.94-1.515L22 17"
                  />
                </svg>
                Encode & Download
              </button>
            </div>
          </div>

          <!-- Audio Decode -->
          <div class="inner-panel" id="inner-audio-decode">
            <div class="upload-zone" id="audio-decode-dropzone">
              <input
                type="file"
                id="audio-decode-input"
                accept="audio/wav"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M9 18V5l12-2v13" />
                  <circle cx="6" cy="18" r="3" />
                  <circle cx="18" cy="16" r="3" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop encoded WAV here</p>
                  <span class="upload-hint">WAV format only</span>
                </div>
              </div>
              <div class="preview-thumb" id="audio-decode-preview" hidden>
                <svg
                  class="audio-thumb-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path d="M9 18V5l12-2v13" />
                  <circle cx="6" cy="18" r="3" />
                  <circle cx="18" cy="16" r="3" />
                </svg>
                <span class="preview-label" id="audio-decode-filename"
                  >audio.wav</span
                >
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-remove"
                    id="audio-decode-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <div id="audio-dec-actions" hidden>
              <div class="input-group">
                <label for="audio-decode-password">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0110 0v4" />
                  </svg>
                  Password <span class="optional">(if encrypted)</span>
                </label>
                <div class="password-input">
                  <input
                    type="password"
                    id="audio-decode-password"
                    placeholder="Enter password to decrypt..."
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-audio-decode-password"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="audio-decode-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 21l-6-6M10 4v6M7 7h6" />
                  <circle cx="10" cy="10" r="7" />
                </svg>
                Decode Message
              </button>

              <div class="result-box" id="audio-result-box" hidden>
                <div class="result-header">
                  <h3>Hidden Message</h3>
                  <button class="copy-btn" id="audio-copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <p class="result-message" id="audio-result-message"></p>
              </div>
            </div>
          </div>
        </section>

        <!-- Scramble Section -->
        <section class="panel" id="scramble-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="scramble">
              Scramble
            </button>
            <button class="inner-tab" data-inner="unscramble">
              Unscramble
            </button>
          </nav>

          <!-- Inner: Scramble -->
          <div class="inner-panel active" id="inner-scramble">
            <div class="upload-zone" id="scramble-dropzone">
              <input type="file" id="scramble-input" accept="image/*" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="3" y="3" width="7" height="7" />
                  <rect x="14" y="3" width="7" height="7" />
                  <rect x="14" y="14" width="7" height="7" />
                  <rect x="3" y="14" width="7" height="7" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop image to scramble</p>
                  <span class="upload-hint"
                    >Password-based pixel scrambling</span
                  >
                </div>
              </div>
              <div class="preview-thumb" id="scramble-preview" hidden>
                <img id="scramble-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-view"
                    data-target="scramble-preview-img"
                    title="View"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="preview-remove"
                    id="scramble-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <span class="preview-label">Image loaded</span>
              </div>
            </div>

            <div id="scramble-actions" hidden>
              <div class="input-group">
                <label for="scramble-password">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0110 0v4" />
                  </svg>
                  Password <span class="optional">(required)</span>
                </label>
                <div class="password-input">
                  <input
                    type="password"
                    id="scramble-password"
                    placeholder="Enter password to scramble..."
                    autocomplete="off"
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-scramble-password"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="scramble-action-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="3" y="3" width="7" height="7" />
                  <rect x="14" y="3" width="7" height="7" />
                  <rect x="14" y="14" width="7" height="7" />
                  <rect x="3" y="14" width="7" height="7" />
                </svg>
                Scramble Image
              </button>
            </div>
          </div>

          <!-- Inner: Unscramble -->
          <div class="inner-panel" id="inner-unscramble">
            <div class="upload-zone" id="unscramble-dropzone">
              <input
                type="file"
                id="unscramble-input"
                accept="image/*"
                hidden
              />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <path d="M9 12l2 2 4-4" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop scrambled image</p>
                  <span class="upload-hint">Must start with scramble_</span>
                </div>
              </div>
              <div class="preview-thumb" id="unscramble-preview" hidden>
                <img id="unscramble-preview-img" alt="Preview" />
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-view"
                    data-target="unscramble-preview-img"
                    title="View"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="preview-remove"
                    id="unscramble-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <span class="preview-label">Image loaded</span>
              </div>
            </div>

            <div id="unscramble-actions" hidden>
              <div class="input-group">
                <label for="unscramble-password">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0110 0v4" />
                  </svg>
                  Password <span class="optional">(required)</span>
                </label>
                <div class="password-input">
                  <input
                    type="password"
                    id="unscramble-password"
                    placeholder="Enter password to unscramble..."
                    autocomplete="off"
                  />
                  <button
                    type="button"
                    class="toggle-password"
                    id="toggle-unscramble-password"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      class="eye-icon"
                    >
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                  </button>
                </div>
              </div>

              <button class="btn primary" id="unscramble-action-btn" disabled>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <path d="M9 12l2 2 4-4" />
                </svg>
                Unscramble Image
              </button>
            </div>
          </div>
        </section>

        <!-- Morse Code Panel -->
        <section class="panel" id="morse-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="morse-encode">
              Encode
            </button>
            <button class="inner-tab" data-inner="morse-decode">Decode</button>
          </nav>

          <div class="inner-panel active" id="inner-morse-encode">
            <div class="input-group">
              <label>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="label-icon"
                >
                  <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                  <polyline points="17 8 12 3 7 8" />
                  <line x1="12" y1="3" x2="12" y2="15" />
                </svg>
                Text to Encode
              </label>
              <div class="textarea-wrap">
                <textarea
                  id="morse-encode-input"
                  placeholder="Enter text to convert to morse code..."
                  rows="4"
                ></textarea>
                <button
                  type="button"
                  class="textarea-clear"
                  data-target="morse-encode-input"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>
            <button class="btn primary" id="morse-encode-btn">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
                <path d="M8 12h8M12 8v8" />
              </svg>
              Encode to Morse
            </button>
            <div class="input-group" id="morse-encode-result" hidden>
              <label>Morse Code Output</label>
              <textarea
                id="morse-encode-output"
                readonly
                rows="4"
                style="font-family: monospace"
              ></textarea>
              <div class="btn-row" style="margin-top: 0.75rem; gap: 0.5rem">
                <button class="btn secondary small" id="morse-copy-btn">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <rect x="9" y="9" width="13" height="13" rx="2" />
                    <path
                      d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                    />
                  </svg>
                  Copy
                </button>
                <button class="btn secondary small" id="morse-play-btn">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polygon points="5 3 19 12 5 21 5 3" />
                  </svg>
                  Play Audio
                </button>
              </div>
            </div>
          </div>

          <div class="inner-panel" id="inner-morse-decode">
            <div class="input-group">
              <label>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="label-icon"
                >
                  <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                  <polyline points="7 10 12 15 17 10" />
                  <line x1="12" y1="15" x2="12" y2="3" />
                </svg>
                Morse Code Input
              </label>
              <div class="textarea-wrap">
                <textarea
                  id="morse-decode-input"
                  placeholder="Enter morse code (use . and - separated by spaces)..."
                  rows="4"
                  style="font-family: monospace"
                ></textarea>
                <button
                  type="button"
                  class="textarea-clear"
                  data-target="morse-decode-input"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
              <span class="input-hint"
                >Use dots (.) and dashes (-), separate letters with spaces,
                words with /</span
              >
            </div>
            <button class="btn primary" id="morse-decode-btn">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
                <path d="M8 12h8" />
              </svg>
              Decode to Text
            </button>
            <div class="input-group" id="morse-decode-result" hidden>
              <label>Decoded Text</label>
              <textarea id="morse-decode-output" readonly rows="3"></textarea>
            </div>
          </div>
        </section>

        <!-- Text Cipher Panel -->
        <section class="panel" id="cipher-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="cipher-encode">
              Encrypt
            </button>
            <button class="inner-tab" data-inner="cipher-decode">
              Decrypt
            </button>
          </nav>

          <div class="inner-panel active" id="inner-cipher-encode">
            <div class="crypto-card">
              <div class="input-group">
                <label>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                    <polyline points="17 8 12 3 7 8" />
                    <line x1="12" y1="3" x2="12" y2="15" />
                  </svg>
                  Text to Encrypt
                </label>
                <div class="textarea-wrap">
                  <textarea
                    id="cipher-encode-input"
                    placeholder="Enter text to encrypt..."
                    rows="3"
                  ></textarea>
                  <button
                    type="button"
                    class="textarea-clear"
                    data-target="cipher-encode-input"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18" />
                      <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                  </button>
                </div>
              </div>
              <div class="input-group">
                <label>Cipher Type</label>
                <select id="cipher-type">
                  <option value="caesar">Caesar Cipher (Shift)</option>
                  <option value="rot13">ROT13</option>
                  <option value="atbash">Atbash (Reverse Alphabet)</option>
                  <option value="vigenere">Vigen√®re Cipher</option>
                </select>
              </div>
              <div class="input-group" id="cipher-shift-group">
                <label
                  >Shift Amount: <span id="cipher-shift-value">3</span></label
                >
                <input
                  type="range"
                  id="cipher-shift"
                  min="1"
                  max="25"
                  value="3"
                  style="width: 100%"
                />
              </div>
              <div class="input-group" id="cipher-key-group" hidden>
                <label>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <path
                      d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 11-7.778 7.778 5.5 5.5 0 017.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"
                    />
                  </svg>
                  Key (letters only)
                </label>
                <input
                  type="text"
                  id="cipher-key"
                  placeholder="Enter key word..."
                />
              </div>
              <button
                class="btn primary"
                id="cipher-encode-btn"
                style="width: 100%"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0110 0v4" />
                </svg>
                Encrypt
              </button>
            </div>

            <div
              class="crypto-card result-card"
              id="cipher-encode-result"
              hidden
            >
              <div class="input-group">
                <label>Encrypted Text</label>
                <textarea
                  id="cipher-encode-output"
                  readonly
                  rows="3"
                  style="font-family: monospace"
                ></textarea>
              </div>
              <button
                class="btn secondary small"
                id="cipher-encode-copy-btn"
                style="margin-top: 0.75rem"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="9" y="9" width="13" height="13" rx="2" />
                  <path
                    d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                  />
                </svg>
                Copy
              </button>
            </div>
          </div>

          <div class="inner-panel" id="inner-cipher-decode">
            <div class="input-group">
              <label>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  class="label-icon"
                >
                  <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                  <polyline points="7 10 12 15 17 10" />
                  <line x1="12" y1="15" x2="12" y2="3" />
                </svg>
                Text to Decrypt
              </label>
              <div class="textarea-wrap">
                <textarea
                  id="cipher-decode-input"
                  placeholder="Enter encrypted text..."
                  rows="3"
                  style="font-family: monospace"
                ></textarea>
                <button
                  type="button"
                  class="textarea-clear"
                  data-target="cipher-decode-input"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                  </svg>
                </button>
              </div>
            </div>
            <div class="input-group">
              <label>Cipher Type</label>
              <select id="cipher-decode-type">
                <option value="caesar">Caesar Cipher (Shift)</option>
                <option value="rot13">ROT13</option>
                <option value="atbash">Atbash (Reverse Alphabet)</option>
                <option value="vigenere">Vigen√®re Cipher</option>
              </select>
            </div>
            <div class="input-group" id="cipher-decode-shift-group">
              <label
                >Shift Amount:
                <span id="cipher-decode-shift-value">3</span></label
              >
              <input
                type="range"
                id="cipher-decode-shift"
                min="1"
                max="25"
                value="3"
                style="width: 100%"
              />
            </div>
            <div class="input-group" id="cipher-decode-key-group" hidden>
              <label>Key (letters only)</label>
              <input
                type="text"
                id="cipher-decode-key"
                placeholder="Enter key word..."
              />
            </div>
            <button class="btn primary" id="cipher-decode-btn">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                <path d="M7 11V7a5 5 0 019.9-1" />
              </svg>
              Decrypt
            </button>
            <div class="input-group" id="cipher-decode-result" hidden>
              <label>Decrypted Text</label>
              <textarea id="cipher-decode-output" readonly rows="3"></textarea>
            </div>
          </div>
        </section>

        <!-- Number System Panel -->
        <section class="panel" id="number-system-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="number-convert">
              Convert
            </button>
            <button class="inner-tab" data-inner="number-text">Text</button>
          </nav>

          <div class="inner-panel active" id="inner-number-convert">
            <div class="crypto-card">
              <div class="input-group">
                <label>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <rect x="4" y="2" width="16" height="20" rx="2" />
                    <line x1="8" y1="6" x2="16" y2="6" />
                    <line x1="8" y1="10" x2="16" y2="10" />
                    <line x1="8" y1="14" x2="12" y2="14" />
                  </svg>
                  Input Value
                </label>
                <input
                  type="text"
                  id="number-input"
                  placeholder="Enter a number..."
                />
              </div>

              <div class="input-group">
                <label>Input Base</label>
                <select id="number-from-base">
                  <option value="2">Binary (Base 2)</option>
                  <option value="8">Octal (Base 8)</option>
                  <option value="10" selected>Decimal (Base 10)</option>
                  <option value="16">Hexadecimal (Base 16)</option>
                </select>
              </div>

              <button
                class="btn primary"
                id="number-convert-btn"
                style="width: 100%"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polyline points="23 4 23 10 17 10" />
                  <polyline points="1 20 1 14 7 14" />
                  <path
                    d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"
                  />
                </svg>
                Convert
              </button>
            </div>

            <div
              class="analysis-results crypto-card result-card"
              id="number-results"
              hidden
              style="padding: 0; overflow: hidden"
            >
              <div
                class="result-header"
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  padding: 12px 16px;
                  background: var(--bg-tertiary);
                  border-bottom: 1px solid var(--border-color);
                "
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--accent)"
                  stroke-width="2"
                >
                  <polyline points="23 4 23 10 17 10" />
                  <polyline points="1 20 1 14 7 14" />
                  <path
                    d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"
                  />
                </svg>
                <h3 style="font-size: 0.95rem; font-weight: 600">
                  Conversion Results
                </h3>
              </div>
              <div
                class="analysis-content"
                style="
                  padding: 16px;
                  display: flex;
                  flex-direction: column;
                  gap: 12px;
                "
              >
                <div
                  class="meta-row"
                  style="
                    display: flex;
                    justify-content: space-between;
                    font-size: 0.9rem;
                    padding: 8px 12px;
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                  "
                >
                  <span style="color: var(--text-secondary)">Binary (2):</span>
                  <span
                    id="result-binary"
                    style="font-weight: 500; font-family: monospace"
                  ></span>
                </div>
                <div
                  class="meta-row"
                  style="
                    display: flex;
                    justify-content: space-between;
                    font-size: 0.9rem;
                    padding: 8px 12px;
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                  "
                >
                  <span style="color: var(--text-secondary)">Octal (8):</span>
                  <span
                    id="result-octal"
                    style="font-weight: 500; font-family: monospace"
                  ></span>
                </div>
                <div
                  class="meta-row"
                  style="
                    display: flex;
                    justify-content: space-between;
                    font-size: 0.9rem;
                    padding: 8px 12px;
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                  "
                >
                  <span style="color: var(--text-secondary)"
                    >Decimal (10):</span
                  >
                  <span
                    id="result-decimal"
                    style="font-weight: 500; font-family: monospace"
                  ></span>
                </div>
                <div
                  class="meta-row"
                  style="
                    display: flex;
                    justify-content: space-between;
                    font-size: 0.9rem;
                    padding: 8px 12px;
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                  "
                >
                  <span style="color: var(--text-secondary)"
                    >Hexadecimal (16):</span
                  >
                  <span
                    id="result-hex"
                    style="font-weight: 500; font-family: monospace"
                  ></span>
                </div>
              </div>
            </div>
          </div>

          <div class="inner-panel" id="inner-number-text">
            <div class="crypto-card">
              <div class="input-group">
                <label>Text Input</label>
                <textarea
                  id="text-binary-input"
                  rows="3"
                  placeholder="Enter text..."
                ></textarea>
              </div>
              <button
                class="btn primary"
                id="text-binary-convert-btn"
                style="width: 100%"
              >
                Convert to Binary/Hex
              </button>
            </div>

            <div class="crypto-card result-card" id="text-binary-result" hidden>
              <div class="input-group">
                <span class="label">Binary</span>
                <textarea
                  id="text-binary-output"
                  readonly
                  rows="3"
                  style="
                    width: 100%;
                    background: transparent;
                    border: none;
                    color: inherit;
                    font-family: monospace;
                    resize: none;
                  "
                ></textarea>
              </div>
              <div
                class="input-group"
                style="
                  border-top: 1px solid var(--border-color);
                  padding-top: 8px;
                  margin-top: 8px; /* Override margin reset maybe? check visually */
                "
              >
                <span class="label">Hex</span>
                <textarea
                  id="text-hex-output"
                  readonly
                  rows="3"
                  style="
                    width: 100%;
                    background: transparent;
                    border: none;
                    color: inherit;
                    font-family: monospace;
                    resize: none;
                  "
                ></textarea>
              </div>
            </div>
          </div>
        </section>

        <!-- Secret Link Panel -->
        <!-- Invisible Ink Panel -->
        <section class="panel" id="invisible-ink-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="ink-encode">
              Encode
            </button>
            <button class="inner-tab" data-inner="ink-decode">Decode</button>
          </nav>

          <div class="inner-panel active" id="inner-ink-encode">
            <div class="crypto-card">
              <div class="input-group">
                <label>Cover Text (Public)</label>
                <div class="textarea-wrap">
                  <textarea
                    id="ink-cover-input"
                    placeholder="Enter normal text (e.g. valid sentence)..."
                    rows="3"
                  ></textarea>
                  <button
                    type="button"
                    class="textarea-clear"
                    data-target="ink-cover-input"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18" />
                      <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                  </button>
                </div>
              </div>
              <div class="input-group">
                <label>Secret Message (Hidden)</label>
                <div class="textarea-wrap">
                  <textarea
                    id="ink-secret-input"
                    placeholder="Enter message to hide..."
                    rows="3"
                  ></textarea>
                  <button
                    type="button"
                    class="textarea-clear"
                    data-target="ink-secret-input"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18" />
                      <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                  </button>
                </div>
              </div>
              <button
                class="btn primary"
                id="ink-encode-btn"
                style="width: 100%"
              >
                Embed Message
              </button>
            </div>

            <div
              class="crypto-card result-card"
              id="ink-encode-result"
              hidden
              style="padding: 0; overflow: hidden"
            >
              <div class="result-box" style="box-shadow: none; margin: 0">
                <div
                  class="result-header"
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 16px;
                    background: var(--bg-tertiary);
                    border-bottom: 1px solid var(--border-color);
                  "
                >
                  <h3 style="font-size: 0.95rem; margin: 0">
                    Result with Invisible Ink
                  </h3>
                  <button class="copy-btn" id="ink-copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <div
                  class="result-message"
                  id="ink-encode-output"
                  style="
                    padding: 16px;
                    white-space: pre-wrap;
                    font-family: inherit;
                  "
                ></div>
              </div>
              <div
                style="
                  padding: 12px 16px;
                  background: var(--bg-secondary);
                  border-top: 1px solid var(--border-color);
                "
              >
                <span
                  class="input-hint"
                  style="color: var(--text-secondary); font-size: 0.85rem"
                  >Looks identical, but contains hidden message. Copy and paste
                  to test!</span
                >
              </div>
            </div>
          </div>

          <div class="inner-panel" id="inner-ink-decode">
            <div class="crypto-card">
              <div class="input-group">
                <label>Text with Invisible Ink</label>
                <div class="textarea-wrap">
                  <textarea
                    id="ink-decode-input"
                    placeholder="Paste text here to extract message..."
                    rows="4"
                  ></textarea>
                  <button
                    type="button"
                    class="textarea-clear"
                    data-target="ink-decode-input"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18" />
                      <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                  </button>
                </div>
              </div>
              <button
                class="btn primary"
                id="ink-decode-btn"
                style="width: 100%"
              >
                Extract Message
              </button>
            </div>

            <div
              class="crypto-card result-card"
              id="ink-decode-result"
              hidden
              style="padding: 0; overflow: hidden"
            >
              <div class="result-box" style="box-shadow: none; margin: 0">
                <div
                  class="result-header"
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 16px;
                    background: var(--bg-tertiary);
                    border-bottom: 1px solid var(--border-color);
                  "
                >
                  <h3 style="font-size: 0.95rem; margin: 0">
                    Hidden Message Found
                  </h3>
                  <button class="copy-btn" id="ink-decode-copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <div
                  class="result-message"
                  id="ink-decode-output"
                  style="
                    padding: 16px;
                    white-space: pre-wrap;
                    font-family: inherit;
                  "
                ></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Hash Generator Panel -->
        <section class="panel" id="hash-gen-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="hash-text">
              Text
            </button>
            <button class="inner-tab" data-inner="hash-file">File</button>
          </nav>

          <div class="inner-panel active" id="inner-hash-text">
            <div class="crypto-card">
              <div class="input-group">
                <label>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <line x1="4" y1="9" x2="20" y2="9" />
                    <line x1="4" y1="15" x2="20" y2="15" />
                    <line x1="10" y1="3" x2="8" y2="21" />
                    <line x1="16" y1="3" x2="14" y2="21" />
                  </svg>
                  Text to Hash
                </label>
                <textarea
                  id="hash-text-input"
                  placeholder="Enter text to generate hash..."
                  rows="4"
                ></textarea>
              </div>
              <button
                class="btn primary"
                id="hash-text-btn"
                style="width: 100%"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <line x1="4" y1="9" x2="20" y2="9" />
                  <line x1="4" y1="15" x2="20" y2="15" />
                  <line x1="10" y1="3" x2="8" y2="21" />
                  <line x1="16" y1="3" x2="14" y2="21" />
                </svg>
                Generate Hashes
              </button>
            </div>

            <div
              class="analysis-results crypto-card result-card"
              id="hash-text-results"
              hidden
              style="padding: 0; overflow: hidden"
            >
              <div
                class="result-header"
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  padding: 12px 16px;
                  background: var(--bg-tertiary);
                  border-bottom: 1px solid var(--border-color);
                "
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--accent)"
                  stroke-width="2"
                >
                  <line x1="4" y1="9" x2="20" y2="9" />
                  <line x1="4" y1="15" x2="20" y2="15" />
                  <line x1="10" y1="3" x2="8" y2="21" />
                  <line x1="16" y1="3" x2="14" y2="21" />
                </svg>
                <h3 style="font-size: 0.95rem; font-weight: 600">
                  Hash Results
                </h3>
              </div>
              <div
                class="analysis-content"
                style="
                  padding: 16px;
                  display: flex;
                  flex-direction: column;
                  gap: 12px;
                "
              >
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >MD5</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-md5"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-md5"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >SHA-1</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-sha1"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-sha1"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >SHA-256</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-sha256"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-sha256"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >SHA-512</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-sha512"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-sha512"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
              </div>
            </div>
          </div>

          <div class="inner-panel" id="inner-hash-file">
            <div class="upload-zone" id="hash-file-dropzone">
              <input type="file" id="hash-file-input" hidden />
              <div class="upload-content">
                <svg
                  class="upload-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
                  />
                  <polyline points="14 2 14 8 20 8" />
                </svg>
                <div class="upload-info">
                  <p class="upload-text">Drop file to hash</p>
                  <span class="upload-hint">Any file type supported</span>
                </div>
              </div>
              <div class="preview-thumb" id="hash-file-preview" hidden>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  width="40"
                  height="40"
                >
                  <path
                    d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
                  />
                  <polyline points="14 2 14 8 20 8" />
                </svg>
                <span class="preview-label" id="hash-file-name"
                  >File loaded</span
                >
                <div class="preview-actions">
                  <button
                    type="button"
                    class="preview-remove"
                    id="hash-file-remove"
                    title="Remove"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>
            <button class="btn primary" id="hash-file-btn" disabled>
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <line x1="4" y1="9" x2="20" y2="9" />
                <line x1="4" y1="15" x2="20" y2="15" />
                <line x1="10" y1="3" x2="8" y2="21" />
                <line x1="16" y1="3" x2="14" y2="21" />
              </svg>
              Generate File Hash
            </button>
            <div
              class="analysis-results"
              id="hash-file-results"
              hidden
              style="
                background: var(--bg-secondary);
                border-radius: 12px;
                border: 1px solid var(--border-color);
                overflow: hidden;
                margin-top: 1rem;
              "
            >
              <div
                class="result-header"
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  padding: 12px 16px;
                  background: var(--bg-tertiary);
                  border-bottom: 1px solid var(--border-color);
                "
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--accent)"
                  stroke-width="2"
                >
                  <line x1="4" y1="9" x2="20" y2="9" />
                  <line x1="4" y1="15" x2="20" y2="15" />
                  <line x1="10" y1="3" x2="8" y2="21" />
                  <line x1="16" y1="3" x2="14" y2="21" />
                </svg>
                <h3 style="font-size: 0.95rem; font-weight: 600">
                  File Hash Results
                </h3>
              </div>
              <div
                class="analysis-content"
                style="
                  padding: 16px;
                  display: flex;
                  flex-direction: column;
                  gap: 12px;
                "
              >
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >MD5</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-file-md5"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-file-md5"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >SHA-1</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-file-sha1"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-file-sha1"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >SHA-256</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-file-sha256"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-file-sha256"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
                <div
                  class="hash-row"
                  style="
                    background: var(--bg-tertiary);
                    border-radius: 8px;
                    padding: 12px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      margin-bottom: 6px;
                    "
                  >
                    <span
                      style="color: var(--text-secondary); font-size: 0.85rem"
                      >SHA-512</span
                    >
                    <button
                      class="copy-btn hash-copy"
                      data-target="hash-file-sha512"
                      title="Copy"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" />
                        <path
                          d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                        />
                      </svg>
                      Copy
                    </button>
                  </div>
                  <code
                    id="hash-file-sha512"
                    style="
                      font-size: 0.8rem;
                      word-break: break-all;
                      color: var(--text-primary);
                    "
                  ></code>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Tools Panel -->
        <section class="panel" id="tools-panel">
          <nav class="inner-tabs">
            <button class="inner-tab active" data-inner="text-repeater">
              Text Repeater
            </button>
            <button class="inner-tab" data-inner="password-gen">
              Password
            </button>
            <button class="inner-tab" data-inner="number-roman">Roman</button>
          </nav>

          <div class="inner-panel active" id="inner-text-repeater">
            <div class="crypto-card">
              <div class="input-group">
                <label>Text to Repeat</label>
                <textarea
                  id="repeat-text-input"
                  placeholder="Enter text to repeat..."
                  rows="2"
                ></textarea>
              </div>

              <div
                class="row"
                style="display: flex; gap: 1rem; margin-bottom: 1rem"
              >
                <div class="input-group" style="flex: 1">
                  <label>Repetitions</label>
                  <input
                    type="number"
                    id="repeat-count"
                    min="1"
                    max="1000"
                    value="10"
                  />
                </div>
                <div class="input-group" style="flex: 1">
                  <label>Separator</label>
                  <div class="custom-select">
                    <select id="repeat-separator">
                      <option value="\n">New Line</option>
                      <option value=" ">Space</option>
                      <option value=", ">Comma</option>
                      <option value=". ">Period</option>
                      <option value="">None</option>
                    </select>
                    <svg
                      class="select-arrow"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="6 9 12 15 18 9" />
                    </svg>
                  </div>
                </div>
              </div>

              <button class="btn primary" id="repeat-btn" style="width: 100%">
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M17 1l4 4-4 4" />
                  <path d="M3 11V9a4 4 0 014-4h14" />
                  <path d="M7 23l-4-4 4-4" />
                  <path d="M21 13v2a4 4 0 01-4 4H3" />
                </svg>
                Repeat Text
              </button>
            </div>

            <div
              id="repeat-result"
              hidden
              class="crypto-card result-card"
              style="padding: 0; overflow: hidden"
            >
              <div class="result-box" style="box-shadow: none; margin: 0">
                <div
                  class="result-header"
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 16px;
                    background: var(--bg-tertiary);
                    border-bottom: 1px solid var(--border-color);
                  "
                >
                  <h3 style="font-size: 0.95rem; margin: 0">Result</h3>
                  <button class="copy-btn" id="repeat-copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <div
                  class="result-message"
                  id="repeat-output"
                  style="
                    padding: 16px;
                    white-space: pre-wrap;
                    max-height: 200px;
                    overflow-y: auto;
                  "
                ></div>
              </div>
            </div>
          </div>

          <div class="inner-panel" id="inner-password-gen">
            <div class="crypto-card">
              <div class="input-group">
                <label
                  >Password Length: <span id="pwd-length-value">16</span></label
                >
                <input
                  type="range"
                  id="pwd-length"
                  min="8"
                  max="64"
                  value="16"
                  style="width: 100%"
                />
              </div>

              <div class="input-group">
                <label style="margin-bottom: 12px">Include Characters</label>
                <div style="display: flex; flex-wrap: wrap; gap: 12px">
                  <label
                    style="
                      display: flex;
                      align-items: center;
                      gap: 6px;
                      cursor: pointer;
                    "
                  >
                    <input type="checkbox" id="pwd-upper" checked />
                    <span style="font-size: 0.9rem">Uppercase (A-Z)</span>
                  </label>
                  <label
                    style="
                      display: flex;
                      align-items: center;
                      gap: 6px;
                      cursor: pointer;
                    "
                  >
                    <input type="checkbox" id="pwd-lower" checked />
                    <span style="font-size: 0.9rem">Lowercase (a-z)</span>
                  </label>
                  <label
                    style="
                      display: flex;
                      align-items: center;
                      gap: 6px;
                      cursor: pointer;
                    "
                  >
                    <input type="checkbox" id="pwd-numbers" checked />
                    <span style="font-size: 0.9rem">Numbers (0-9)</span>
                  </label>
                  <label
                    style="
                      display: flex;
                      align-items: center;
                      gap: 6px;
                      cursor: pointer;
                    "
                  >
                    <input type="checkbox" id="pwd-symbols" checked />
                    <span style="font-size: 0.9rem">Symbols (!@#$)</span>
                  </label>
                </div>
              </div>

              <button
                class="btn primary"
                id="pwd-generate-btn"
                style="width: 100%"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0110 0v4" />
                </svg>
                Generate Password
              </button>
            </div>

            <div
              class="crypto-card result-card"
              id="pwd-result"
              hidden
              style="padding: 0; overflow: hidden"
            >
              <div class="result-box" style="box-shadow: none; margin: 0">
                <div
                  class="result-header"
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 16px;
                    background: var(--bg-tertiary);
                    border-bottom: 1px solid var(--border-color);
                  "
                >
                  <h3 style="font-size: 0.95rem; margin: 0">
                    Generated Password
                  </h3>
                  <button class="copy-btn" id="pwd-copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <div
                  class="result-message"
                  id="pwd-output"
                  style="
                    padding: 16px;
                    font-family: monospace;
                    font-size: 1.1rem;
                    letter-spacing: 1px;
                  "
                ></div>
              </div>
              <div
                style="
                  padding: 12px;
                  background: var(--bg-tertiary);
                  border-top: 1px solid var(--border-color);
                "
              >
                <div
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                  "
                >
                  <span style="font-size: 0.85rem; color: var(--text-secondary)"
                    >Strength:</span
                  >
                  <span
                    id="pwd-strength"
                    style="font-size: 0.85rem; font-weight: 600"
                  ></span>
                </div>
                <div
                  style="
                    margin-top: 8px;
                    height: 6px;
                    background: var(--bg-secondary);
                    border-radius: 3px;
                    overflow: hidden;
                  "
                >
                  <div
                    id="pwd-strength-bar"
                    style="height: 100%; width: 0%; transition: all 0.3s"
                  ></div>
                </div>
              </div>
            </div>
          </div>

          <div class="inner-panel" id="inner-number-roman">
            <div class="crypto-card">
              <div class="input-group">
                <label>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="label-icon"
                  >
                    <path d="M4 6h16M4 12h16M4 18h16" />
                  </svg>
                  Roman / Decimal Input
                </label>
                <input
                  type="text"
                  id="roman-input"
                  placeholder="Enter number (2024) or Roman (MMXXIV)..."
                />
              </div>
              <button
                class="btn primary"
                id="roman-convert-btn"
                style="width: 100%"
              >
                Convert
              </button>
            </div>

            <div
              class="crypto-card result-card"
              id="roman-result"
              hidden
              style="padding: 0; overflow: hidden"
            >
              <div class="result-box" style="box-shadow: none; margin: 0">
                <div
                  class="result-header"
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 16px;
                    background: var(--bg-tertiary);
                    border-bottom: 1px solid var(--border-color);
                  "
                >
                  <h3 style="font-size: 0.95rem; margin: 0">Result</h3>
                  <button class="copy-btn" id="roman-copy-btn">
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" />
                      <path
                        d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                      />
                    </svg>
                    Copy
                  </button>
                </div>
                <div
                  class="result-message"
                  id="roman-output"
                  style="
                    padding: 16px;
                    font-size: 1.25rem;
                    font-weight: 600;
                    font-family: monospace;
                    word-break: break-all;
                  "
                ></div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div class="modal" id="image-modal" hidden>
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <img id="modal-image" alt="Preview" />
        <button class="modal-close" id="modal-close">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M18 6L6 18M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>

    <div class="toast" id="toast"></div>
    <canvas id="canvas" hidden></canvas>

    <script type="module" src="assets/js/main.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          let refreshing = false;
          navigator.serviceWorker.addEventListener("controllerchange", () => {
            if (!refreshing) {
              window.location.reload();
              refreshing = true;
            }
          });

          navigator.serviceWorker
            .register("/sw.js?v=4.2")
            .then((registration) => {
              console.log("SW registered: ", registration);

              setInterval(() => {
                registration.update();
              }, 60 * 60 * 1000);

              if (registration.waiting) {
                registration.waiting.postMessage({ type: "SKIP_WAITING" });
              }

              registration.onupdatefound = () => {
                const newWorker = registration.installing;
                newWorker.onstatechange = () => {
                  if (newWorker.state === "installed") {
                    if (navigator.serviceWorker.controller) {
                      console.log("New content is available; please refresh.");
                    } else {
                      console.log("Content is cached for offline use.");
                    }
                  }
                };
              };
            })
            .catch((registrationError) => {
              console.log("SW registration failed: ", registrationError);
            });
        });
      }
    </script>
  </body>
</html>
